@echo off
REM ============================================================================
REM SARAB Quick Spoof ? One-click signature randomization
REM ============================================================================
REM Created by: Koldo | Discord: @Koldo1
REM
REM Spoofs existing driver.sys and sarab.exe without rebuilding.
REM Place binaries in output\ folder and run this.
REM ============================================================================

setlocal enabledelayedexpansion

echo.
echo  ???????? ?????? ???????  ?????? ???????
echo  ????????????????????????????????????????
echo  ????????????????????????????????????????
echo  ????????????????????????????????????????
echo  ???????????  ??????  ??????  ???????????
echo  ???????????  ??????  ??????  ??????????
echo        Quick Signature Spoofer
echo        by Koldo ^| Discord: @Koldo1
echo.

set "TOOLS_DIR=%~dp0tools"
set "TARGET_DIR=%~dp0output"

if not exist "%TARGET_DIR%" set "TARGET_DIR=%~dp0"

set "FOUND=0"

if exist "%TARGET_DIR%\driver.sys" (
    echo [*] Spoofing driver.sys ...
    echo.
    pwsh -NoProfile -ExecutionPolicy Bypass -File "%TOOLS_DIR%\signature_randomizer.ps1" -TargetFile "%TARGET_DIR%\driver.sys"
    set "FOUND=1"
    echo.
)

if exist "%TARGET_DIR%\sarab.exe" (
    echo [*] Spoofing sarab.exe ...
    echo.
    pwsh -NoProfile -ExecutionPolicy Bypass -File "%TOOLS_DIR%\signature_randomizer.ps1" -TargetFile "%TARGET_DIR%\sarab.exe"
    set "FOUND=1"
    echo.
)

if "!FOUND!"=="0" (
    echo [ERROR] No driver.sys or sarab.exe found in:
    echo         %TARGET_DIR%
    echo.
    echo Place your compiled binaries in the output\ folder and run again.
)

echo.
echo Done! Binaries now have fresh unique signatures.
echo.
pause
